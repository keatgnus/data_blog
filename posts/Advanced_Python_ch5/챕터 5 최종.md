---
title: "advanced_python CH_5"
author: "Seongtaek"
date: "2023-05-30"
categories: [code, advanced_python, jupyter]
image: "jup_image.jpg"
toc: true
---


<table align="bottom">
  <td>
    <a target="_blank" href="http://localhost:8888/notebooks/3-1%20Python_Hard/%EC%B1%95%ED%84%B0%205%20%EC%B5%9C%EC%A2%85.ipynb#"><img
    src = small_jup_image.jpg />Jupyter에서 실행하기</a>
  </td>
</table>

Pandas Basic

## Advanced Python CH5 - Pandas Basic

```python
import numpy as np
import pandas as pd
```


```python
from pandas import Series, DataFrame
```


```python
import numpy as np
np.random.seed(12345)
import matplotlib.pyplot as plt
plt.rc("figure", figsize=(10, 6))
PREVIOUS_MAX_ROWS = pd.options.display.max_rows
pd.options.display.max_rows = 20
pd.options.display.max_columns = 20
pd.options.display.max_colwidth = 80
np.set_printoptions(precision=4, suppress=True)
```

## Introduction to pandas Data Structures

판다스 시리즈 객체


```python
obj = pd.Series([4, 7, -5, 3])
obj
```




    0    4
    1    7
    2   -5
    3    3
    dtype: int64




```python
obj.array
```




    <PandasArray>
    [4, 7, -5, 3]
    Length: 4, dtype: int64




```python
obj.index
```




    RangeIndex(start=0, stop=4, step=1)




```python
obj2 = pd.Series([4, 7, -5, 3], index=["d", "b", "a", "c"])
obj2
```




    d    4
    b    7
    a   -5
    c    3
    dtype: int64




```python
obj2.index
```




    Index(['d', 'b', 'a', 'c'], dtype='object')




```python
obj2["a"]
obj2["d"] = 6
obj2[["c", "a", "d"]] # 입력 순서대로 정렬
```




    c    3
    a   -5
    d    6
    dtype: int64




```python
obj2[obj2 > 0]
```




    d    6
    b    7
    c    3
    dtype: int64




```python
obj2 * 2
```




    d    12
    b    14
    a   -10
    c     6
    dtype: int64




```python
np.exp(obj2)
```




    d     403.428793
    b    1096.633158
    a       0.006738
    c      20.085537
    dtype: float64




```python
"b" in obj2, "e" in obj2
```




    (True, False)



딕셔너리로 시리즈 객체 만들기


```python
sdata = {"Ohio": 35000, "Texas": 71000, "Oregon": 16000, "Utah": 5000}
obj3 = pd.Series(sdata)
obj3
```




    Ohio      35000
    Texas     71000
    Oregon    16000
    Utah       5000
    dtype: int64




```python
obj3.to_dict() # to_dict : 딕셔너리로 불러오기
```




    {'Ohio': 35000, 'Texas': 71000, 'Oregon': 16000, 'Utah': 5000}




```python
states = ["California", "Ohio", "Oregon", "Texas"]
obj4 = pd.Series(sdata, index=states)
obj4 # 새로운 인덱스 값의 value 값은 NaN
```




    California        NaN
    Ohio          35000.0
    Oregon        16000.0
    Texas         71000.0
    dtype: float64




```python
pd.isna(obj4)
```




    California     True
    Ohio          False
    Oregon        False
    Texas         False
    dtype: bool




```python
pd.notna(obj4)
```




    California    False
    Ohio           True
    Oregon         True
    Texas          True
    dtype: bool




```python
obj4.isna()
```




    California     True
    Ohio          False
    Oregon        False
    Texas         False
    dtype: bool




```python
obj3
obj4
obj3 + obj4 # 중복없는 인덱스 값의 value 값은 NaN
```




    California         NaN
    Ohio           70000.0
    Oregon         32000.0
    Texas         142000.0
    Utah               NaN
    dtype: float64




```python
obj4.name = "population"
obj4.index.name = "state"
obj4
```




    state
    California        NaN
    Ohio          35000.0
    Oregon        16000.0
    Texas         71000.0
    Name: population, dtype: float64




```python
obj
obj.index = ["Bob", "Steve", "Jeff", "Ryan"]
obj # 인덱스 이름 부여
```




    Bob      4
    Steve    7
    Jeff    -5
    Ryan     3
    dtype: int64



## DataFrame


```python
data = {"state": ["Ohio", "Ohio", "Ohio", "Nevada", "Nevada", "Nevada"],
        "year": [2000, 2001, 2002, 2001, 2002, 2003],
        "pop": [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]}
frame = pd.DataFrame(data)
```


```python
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Nevada</td>
      <td>2003</td>
      <td>3.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Ohio</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nevada</td>
      <td>2001</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nevada</td>
      <td>2002</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Nevada</td>
      <td>2003</td>
      <td>3.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(data, columns=["year", "state", "pop"]) # 컬럼 순서 지정
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame2 = pd.DataFrame(data, columns=["year", "state", "pop", "debt"])
frame2 # 새로운 컬럼 값 지정 안하면 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame2.columns
```




    Index(['year', 'state', 'pop', 'debt'], dtype='object')




```python
frame2["state"]
```




    0      Ohio
    1      Ohio
    2      Ohio
    3    Nevada
    4    Nevada
    5    Nevada
    Name: state, dtype: object




```python
frame2.year
```




    0    2000
    1    2001
    2    2002
    3    2001
    4    2002
    5    2003
    Name: year, dtype: int64




```python
frame2.loc[1] # 행 추출
```




    year     2001
    state    Ohio
    pop       1.7
    debt      NaN
    Name: 1, dtype: object




```python
frame2.iloc[2] # 인덱스가 2인것 추출
```




    year     2002
    state    Ohio
    pop       3.6
    debt      NaN
    Name: 2, dtype: object




```python
frame2["debt"] = 16.5
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>16.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame2["debt"] = np.arange(6.)
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
val = pd.Series([-1.2, -1.5, -1.7], index=["two", "four", "five"])
frame2["debt"] = val
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame2["eastern"] = frame2["state"] == "Ohio"
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
      <th>eastern</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>NaN</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>NaN</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>NaN</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>NaN</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>NaN</td>
      <td>False</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>NaN</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
del frame2["eastern"]
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>state</th>
      <th>pop</th>
      <th>debt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>Ohio</td>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001</td>
      <td>Ohio</td>
      <td>1.7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Ohio</td>
      <td>3.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001</td>
      <td>Nevada</td>
      <td>2.4</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Nevada</td>
      <td>2.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2003</td>
      <td>Nevada</td>
      <td>3.2</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame2.columns
```




    Index(['year', 'state', 'pop', 'debt'], dtype='object')




```python
populations = {"Ohio": {2000: 1.5, 2001: 1.7, 2002: 3.6},
               "Nevada": {2001: 2.4, 2002: 2.9}} # 인덱스에 직접 값 지정
```


```python
frame3 = pd.DataFrame(populations)
frame3 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000</th>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>1.7</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>3.6</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame3.T # 행,열 위치 바꾸기
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1.5</td>
      <td>1.7</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>Nevada</th>
      <td>NaN</td>
      <td>2.4</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.DataFrame(populations, index=[2001, 2002, 2003]) # 새로운 인덱스는 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2001</th>
      <td>1.7</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>3.6</td>
      <td>2.9</td>
    </tr>
    <tr>
      <th>2003</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
pdata = {"Ohio": frame3["Ohio"][:-1],
         "Nevada": frame3["Nevada"][:2]}
pd.DataFrame(pdata) # 기존 DF에 조건걸기
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Nevada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000</th>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>1.7</td>
      <td>2.4</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame3.index.name = "year"
frame3.columns.name = "state"
frame3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>Ohio</th>
      <th>Nevada</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000</th>
      <td>1.5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>1.7</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>3.6</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame3.to_numpy()
```




    array([[1.5, nan],
           [1.7, 2.4],
           [3.6, 2.9]])




```python
frame2.to_numpy()
```




    array([[2000, 'Ohio', 1.5, nan],
           [2001, 'Ohio', 1.7, nan],
           [2002, 'Ohio', 3.6, nan],
           [2001, 'Nevada', 2.4, nan],
           [2002, 'Nevada', 2.9, nan],
           [2003, 'Nevada', 3.2, nan]], dtype=object)



## Index Objects


```python
obj = pd.Series(np.arange(3), index=["a", "b", "c"])
index = obj.index
index
index[1:]
```




    Index(['b', 'c'], dtype='object')




```python
labels = pd.Index(np.arange(3))
labels
obj2 = pd.Series([1.5, -2.5, 0], index=labels)
obj2
obj2.index is labels # 동일한 인덱스 인가
```




    True




```python
frame3
frame3.columns
"Ohio" in frame3.columns
2003 in frame3.index
```




    False




```python
pd.Index(["foo", "foo", "bar", "bar"])
```




    Index(['foo', 'foo', 'bar', 'bar'], dtype='object')



## Essential Functionality
### ReIndexing


```python
obj = pd.Series([4.5, 7.2, -5.3, 3.6], index=["d", "b", "a", "c"])
obj
```




    d    4.5
    b    7.2
    a   -5.3
    c    3.6
    dtype: float64




```python
obj2 = obj.reindex(["a", "b", "c", "d", "e"])
obj2
```




    a   -5.3
    b    7.2
    c    3.6
    d    4.5
    e    NaN
    dtype: float64




```python
obj3 = pd.Series(["blue", "purple", "yellow"], index=[0, 2, 4])
obj3
obj3.reindex(np.arange(6), method="ffill") # reindex ffill : 앞에 있는 값으로 채우가
```




    0      blue
    1      blue
    2    purple
    3    purple
    4    yellow
    5    yellow
    dtype: object




```python
frame = pd.DataFrame(np.arange(9).reshape((3, 3)), # 3x3 형태, 0,1,2,... 채우기
                     index=["a", "c", "d"],
                     columns=["Ohio", "Texas", "California"])
frame
frame2 = frame.reindex(index=["a", "b", "c", "d"])
frame2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Texas</th>
      <th>California</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
states = ["Texas", "Utah", "California"]
frame.reindex(columns=states) # 새로운 컬럼은 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Texas</th>
      <th>Utah</th>
      <th>California</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>NaN</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.reindex(states, axis="columns") # 위랑 다른형식, 같은값
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Texas</th>
      <th>Utah</th>
      <th>California</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>c</th>
      <td>4</td>
      <td>NaN</td>
      <td>5</td>
    </tr>
    <tr>
      <th>d</th>
      <td>7</td>
      <td>NaN</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.loc[["a", "d", "c"], ["California", "Texas"]] # 해당 행, 해당 컬럼 추출
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>California</th>
      <th>Texas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>d</th>
      <td>8</td>
      <td>7</td>
    </tr>
    <tr>
      <th>c</th>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>



### Dropping Entries from an Axis


```python
obj = pd.Series(np.arange(5.), index=["a", "b", "c", "d", "e"])
obj
new_obj = obj.drop("c")
new_obj
obj.drop(["d", "c"])
```




    a    0.0
    b    1.0
    e    4.0
    dtype: float64




```python
data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=["Ohio", "Colorado", "Utah", "New York"],
                    columns=["one", "two", "three", "four"])
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop(index=["Colorado", "Ohio"]) # 인덱스 드랍
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop(columns=["two"]) # 컬럼 드랍
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop("two", axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.drop(["two", "four"], axis="columns")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>10</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div>




```python
obj.drop('c', inplace=True) # 원본 시리즈 변경(대체)
obj
```




    a    0.0
    b    1.0
    d    3.0
    e    4.0
    dtype: float64



### Indexing, Selection, and Filtering


```python
obj = pd.Series(np.arange(4.), index=["a", "b", "c", "d"])
obj
```




    a    0.0
    b    1.0
    c    2.0
    d    3.0
    dtype: float64




```python
obj["b"]
```




    1.0




```python
obj[1] # 인덱스 1 의 value 값
```




    1.0




```python
obj[2:4]
```




    c    2.0
    d    3.0
    dtype: float64




```python
obj[["b", "a", "d"]]
```




    b    1.0
    a    0.0
    d    3.0
    dtype: float64




```python
obj[[1, 3]]
```




    b    1.0
    d    3.0
    dtype: float64




```python
obj[obj < 2] # 값이 2보다 작은것
```




    a    0.0
    b    1.0
    dtype: float64




```python
obj.loc[["b", "a", "d"]]
```




    b    1.0
    a    0.0
    d    3.0
    dtype: float64




```python
obj1 = pd.Series([1, 2, 3], index=[2, 0, 1])
obj2 = pd.Series([1, 2, 3], index=["a", "b", "c"])
obj1
obj2
obj1[[0, 1, 2]]
obj2[[0, 1, 2]] # 지정 순서대로
```




    a    1
    b    2
    c    3
    dtype: int64




```python
obj1.iloc[[0, 1, 2]] # iloc : 위치기반
```




    2    1
    0    2
    1    3
    dtype: int64




```python
obj2.iloc[[0, 1, 2]]
```




    a    1
    b    2
    c    3
    dtype: int64




```python
obj2.loc["b":"c"]
```




    b    2
    c    3
    dtype: int64




```python
obj2.loc["b":"c"] = 5
obj2
```




    a    1
    b    5
    c    5
    dtype: int64




```python
data = pd.DataFrame(np.arange(16).reshape((4, 4)),
                    index=["Ohio", "Colorado", "Utah", "New York"],
                    columns=["one", "two", "three", "four"])
data
data["two"]
data[["three", "one"]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>three</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>10</td>
      <td>8</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>14</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[:2] # 행
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[data["three"] > 5] 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data < 5
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>




```python
data[data < 5] = 0
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>






















### Selection with loc & iloc


```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc["Colorado"]
```




    one      0
    two      5
    three    6
    four     7
    Name: Colorado, dtype: int32




```python
data.loc[["Colorado", "New York"]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc["Colorado", ["two", "three"]] # 해당 행인덱스의 해당 열값
```




    two      5
    three    6
    Name: Colorado, dtype: int32




```python
data.iloc[2]
```




    one       8
    two       9
    three    10
    four     11
    Name: Utah, dtype: int32




```python
data.iloc[[2, 1]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.iloc[2, [3, 0, 1]] # 열 값 순서 지정도 가능
```




    four    11
    one      8
    two      9
    Name: Utah, dtype: int32




```python
data.iloc[[1, 2], [3, 0, 1]]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>four</th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>7</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>11</td>
      <td>8</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[:"Utah", "two"]
```




    Ohio        0
    Colorado    5
    Utah        9
    Name: two, dtype: int32




```python
data.iloc[:, :3][data.three > 5] # 모든행, 3전까지 열
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[data.three >= 2] # 해당값이 2이상인것 추출
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>



### Integer Indexes


```python
ser = pd.Series(np.arange(3.))
ser
```




    0    0.0
    1    1.0
    2    2.0
    dtype: float64




```python
ser.iloc[-1] # 마지막 선택
```




    2.0




```python
ser2 = pd.Series(np.arange(3.), index=["a", "b", "c"])
ser2
```




    a    0.0
    b    1.0
    c    2.0
    dtype: float64




```python
ser2[-1]
```




    2.0




```python
ser.iloc[-1]
```




    2.0




```python
ser[:2]
```




    0    0.0
    1    1.0
    dtype: float64




```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>0</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>



loc, iloc로 값 바꾸기


```python
data.loc[:, "one"] = 1
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>1</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>1</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.iloc[2] = 5
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>1</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>1</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[data["four"] > 5] = 3
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[data.three == 5]["three"] = 6
data # 잘못된 경우
```

    C:\Users\seong taek\AppData\Local\Temp\ipykernel_15512\2485902161.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      data.loc[data.three == 5]["three"] = 6
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.loc[data.three == 5, "three"] = 6
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>5</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>



### Arithmetic & Data Alignment


```python
s1 = pd.Series([7.3, -2.5, 3.4, 1.5], index=["a", "c", "d", "e"])
s2 = pd.Series([-2.1, 3.6, -1.5, 4, 3.1],
               index=["a", "c", "e", "f", "g"])
s1
```




    a    7.3
    c   -2.5
    d    3.4
    e    1.5
    dtype: float64




```python
s2
```




    a   -2.1
    c    3.6
    e   -1.5
    f    4.0
    g    3.1
    dtype: float64




```python
s1 + s2 # 시리즈끼리 더하면 하나라도 없는값 NaN
```




    a    5.2
    c    1.1
    d    NaN
    e    0.0
    f    NaN
    g    NaN
    dtype: float64




```python
df1 = pd.DataFrame(np.arange(9.).reshape((3, 3)), columns=list("bcd"),
                   index=["Ohio", "Texas", "Colorado"])
df2 = pd.DataFrame(np.arange(12.).reshape((4, 3)), columns=list("bde"),
                   index=["Utah", "Ohio", "Texas", "Oregon"])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Colorado</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 + df2 # 없는 행이나 열: NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>3.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>9.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Utah</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 = pd.DataFrame({"A": [1, 2]})
df2 = pd.DataFrame({"B": [3, 4]})
df1
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 + df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 = pd.DataFrame(np.arange(12.).reshape((3, 4)),
                   columns=list("abcd"))
df2 = pd.DataFrame(np.arange(20.).reshape((4, 5)),
                   columns=list("abcde"))
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>19.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2.loc[1, "b"] = np.nan
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>19.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1 + df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.0</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.add(df2, fill_value=0) # NaN 값 되는거 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.0</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>19.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
1 / df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>inf</td>
      <td>1.000000</td>
      <td>0.500000</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250</td>
      <td>0.200000</td>
      <td>0.166667</td>
      <td>0.142857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.125</td>
      <td>0.111111</td>
      <td>0.100000</td>
      <td>0.090909</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.rdiv(1) # 역수
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>inf</td>
      <td>1.000000</td>
      <td>0.500000</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.250</td>
      <td>0.200000</td>
      <td>0.166667</td>
      <td>0.142857</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.125</td>
      <td>0.111111</td>
      <td>0.100000</td>
      <td>0.090909</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.reindex(columns=df2.columns, fill_value=0) # 컬럼 추가
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df1.reindex(columns=['e'], fill_value=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
arr = np.arange(12.).reshape((3, 4))
arr
```




    array([[ 0.,  1.,  2.,  3.],
           [ 4.,  5.,  6.,  7.],
           [ 8.,  9., 10., 11.]])




```python
arr[0]
```




    array([0., 1., 2., 3.])




```python
arr - arr[0] # 각각의 행값이 계산됨
```




    array([[0., 0., 0., 0.],
           [4., 4., 4., 4.],
           [8., 8., 8., 8.]])




```python
frame = pd.DataFrame(np.arange(12.).reshape((4, 3)),
                     columns=list("bde"),
                     index=["Utah", "Ohio", "Texas", "Oregon"])
series = frame.iloc[0]
series
```




    b    0.0
    d    1.0
    e    2.0
    Name: Utah, dtype: float64




```python
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>6.0</td>
      <td>7.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>11.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame - series # 시리즈 값만큼 각각 계산
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>9.0</td>
      <td>9.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
series2 = pd.Series(np.arange(3), index=["b", "e", "f"])
series2
```




    b    0
    e    1
    f    2
    dtype: int32




```python
frame + series2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>3.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>6.0</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>9.0</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
series3 = frame["d"]
series3
```




    Utah       1.0
    Ohio       4.0
    Texas      7.0
    Oregon    10.0
    Name: d, dtype: float64




```python
frame.sub(series3, axis="index") # index기준으로 빼기
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>-1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>-1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>-1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame = pd.DataFrame(np.random.standard_normal((4, 3)),
                     columns=list("bde"),
                     index=["Utah", "Ohio", "Texas", "Oregon"])
frame
np.abs(frame)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.204708</td>
      <td>0.478943</td>
      <td>0.519439</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>0.555730</td>
      <td>1.965781</td>
      <td>1.393406</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>0.092908</td>
      <td>0.281746</td>
      <td>0.769023</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>1.246435</td>
      <td>1.007189</td>
      <td>1.296221</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>-0.204708</td>
      <td>0.478943</td>
      <td>-0.519439</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>-0.555730</td>
      <td>1.965781</td>
      <td>1.393406</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>0.092908</td>
      <td>0.281746</td>
      <td>0.769023</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>1.246435</td>
      <td>1.007189</td>
      <td>-1.296221</td>
    </tr>
  </tbody>
</table>
</div>




```python
def f1(x):
    return x.max() - x.min() # 열기준

frame.apply(f1)
```




    b    1.802165
    d    1.684034
    e    2.689627
    dtype: float64




```python
frame.apply(f1, axis="columns") # 각 행에 대해
```




    Utah      0.998382
    Ohio      2.521511
    Texas     0.676115
    Oregon    2.542656
    dtype: float64




```python
def f2(x):
    return pd.Series([x.min(), x.max()], index=["min", "max"]) # 시리즈 객체로 최대/최소 값, 인덱스 지정
frame.apply(f2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>-0.555730</td>
      <td>0.281746</td>
      <td>-1.296221</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.246435</td>
      <td>1.965781</td>
      <td>1.393406</td>
    </tr>
  </tbody>
</table>
</div>




```python
def my_format(x):
    return f"{x:.2f}" # 소수점 둘째자리 까지 반올림

frame.applymap(my_format)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>-0.20</td>
      <td>0.48</td>
      <td>-0.52</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>-0.56</td>
      <td>1.97</td>
      <td>1.39</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>0.09</td>
      <td>0.28</td>
      <td>0.77</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>1.25</td>
      <td>1.01</td>
      <td>-1.30</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame["e"].map(my_format) # 소수점 둘째자리 까지 반올림 (map:호출)
```




    Utah      -0.52
    Ohio       1.39
    Texas      0.77
    Oregon    -1.30
    Name: e, dtype: object




```python
obj = pd.Series(np.arange(4), index=["d", "a", "b", "c"])
obj
```




    d    0
    a    1
    b    2
    c    3
    dtype: int32




```python
obj.sort_index() # 인덱스 오름차순
```




    a    1
    b    2
    c    3
    d    0
    dtype: int32




```python
frame = pd.DataFrame(np.arange(8).reshape((2, 4)),
                     index=["three", "one"],
                     columns=["d", "a", "b", "c"])
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>three</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>one</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sort_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>three</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sort_index(axis="columns") # 컬럼 정렬
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>three</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>one</th>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sort_index(axis="columns", ascending=False) # 내림차순
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>c</th>
      <th>b</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>three</th>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>one</th>
      <td>4</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
obj = pd.Series([4, 7, -3, 2])
obj.sort_values() # 시리즈 값들이 오름차순
```




    2   -3
    3    2
    0    4
    1    7
    dtype: int64




```python
obj = pd.Series([4, np.nan, 7, np.nan, -3, 2])
obj.sort_values() # NaN은 맨밑
```




    4   -3.0
    5    2.0
    0    4.0
    2    7.0
    1    NaN
    3    NaN
    dtype: float64




```python
obj.sort_values(na_position="first") # NaN이 첫 번째
```




    1    NaN
    3    NaN
    4   -3.0
    5    2.0
    0    4.0
    2    7.0
    dtype: float64




```python
frame = pd.DataFrame({"b": [4, 7, -3, 2], "a": [0, 1, 0, 1]})
frame
frame.sort_values("b") # b만 정렬
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>-3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sort_values(["a", "b"])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>-3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
obj = pd.Series([7, -5, 7, 4, 2, 0, 4])
obj
```




    0    7
    1   -5
    2    7
    3    4
    4    2
    5    0
    6    4
    dtype: int64




```python
obj.rank()
```




    0    6.5
    1    1.0
    2    6.5
    3    4.5
    4    3.0
    5    2.0
    6    4.5
    dtype: float64




```python
obj.rank(method="first") # 동일 순위있어도 더 큰 순위 표시
```




    0    6.0
    1    1.0
    2    7.0
    3    4.0
    4    3.0
    5    2.0
    6    5.0
    dtype: float64




```python
obj.rank(ascending=False) # 순위 내림차순
```




    0    1.5
    1    7.0
    2    1.5
    3    3.5
    4    5.0
    5    6.0
    6    3.5
    dtype: float64




```python
frame = pd.DataFrame({"b": [4.3, 7, -3, 2], "a": [0, 1, 0, 1],
                      "c": [-2, 5, 8, -2.5]})
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.3</td>
      <td>0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>1</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.0</td>
      <td>0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>1</td>
      <td>-2.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.rank(axis="columns") # 행
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
obj = pd.Series(np.arange(5), index=["a", "a", "b", "b", "c"])
obj
```




    a    0
    a    1
    b    2
    b    3
    c    4
    dtype: int32




```python
obj.index.is_unique # 인덱스에 중복값 있으면 False
```




    False




```python
obj["a"], obj["c"]
```




    (a    0
     a    1
     dtype: int32,
     4)




```python
df = pd.DataFrame(np.random.standard_normal((5, 3)),
                  index=["a", "a", "b", "b", "c"])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.274992</td>
      <td>0.228913</td>
      <td>1.352917</td>
    </tr>
    <tr>
      <th>a</th>
      <td>0.886429</td>
      <td>-2.001637</td>
      <td>-0.371843</td>
    </tr>
    <tr>
      <th>b</th>
      <td>1.669025</td>
      <td>-0.438570</td>
      <td>-0.539741</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.476985</td>
      <td>3.248944</td>
      <td>-1.021228</td>
    </tr>
    <tr>
      <th>c</th>
      <td>-0.577087</td>
      <td>0.124121</td>
      <td>0.302614</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc["b"]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>1.669025</td>
      <td>-0.438570</td>
      <td>-0.539741</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.476985</td>
      <td>3.248944</td>
      <td>-1.021228</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc["c"]
```




    0   -0.577087
    1    0.124121
    2    0.302614
    Name: c, dtype: float64




```python
df = pd.DataFrame([[1.4, np.nan], [7.1, -4.5],
                   [np.nan, np.nan], [0.75, -1.3]],
                  index=["a", "b", "c", "d"],
                  columns=["one", "two"])
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>7.10</td>
      <td>-4.5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>d</th>
      <td>0.75</td>
      <td>-1.3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sum()
```




    one    9.25
    two   -5.80
    dtype: float64




```python
df.sum(axis="columns") #행
```




    a    1.40
    b    2.60
    c    0.00
    d   -0.55
    dtype: float64




```python
# index : 열
df.sum(axis="index", skipna=False) , df.sum(axis="columns", skipna=False) # 결측값 포함 계산 # 행
```




    (one   NaN
     two   NaN
     dtype: float64,
     a     NaN
     b    2.60
     c     NaN
     d   -0.55
     dtype: float64)




```python
df.mean(axis="columns") # 모두 NaN 이었으면 NaN
```




    a    1.400
    b    1.300
    c      NaN
    d   -0.275
    dtype: float64




```python
df.idxmax() # 각 열에 최대값에 해당하는 행 이름 출력
```




    one    b
    two    d
    dtype: object




```python
df.cumsum() # 각 열 누적합
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.40</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>8.50</td>
      <td>-4.5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>d</th>
      <td>9.25</td>
      <td>-5.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.describe() # 각 열 통계정보
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.083333</td>
      <td>-2.900000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.493685</td>
      <td>2.262742</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.750000</td>
      <td>-4.500000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.075000</td>
      <td>-3.700000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.400000</td>
      <td>-2.900000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.250000</td>
      <td>-2.100000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.100000</td>
      <td>-1.300000</td>
    </tr>
  </tbody>
</table>
</div>




```python
obj = pd.Series(["a", "a", "b", "c"] * 4) # 4개 값 만들기
obj
```




    0     a
    1     a
    2     b
    3     c
    4     a
    5     a
    6     b
    7     c
    8     a
    9     a
    10    b
    11    c
    12    a
    13    a
    14    b
    15    c
    dtype: object




```python
obj.describe() # 통계정보
```




    count     16
    unique     3
    top        a
    freq       8
    dtype: object




```python
price = pd.read_pickle("C:/Users/seong taek/3-1 Python_Hard/yahoo_price.pkl")
volume = pd.read_pickle("C:/Users/seong taek/3-1 Python_Hard/yahoo_volume.pkl")
price
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>GOOG</th>
      <th>IBM</th>
      <th>MSFT</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-04</th>
      <td>27.990226</td>
      <td>313.062468</td>
      <td>113.304536</td>
      <td>25.884104</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>28.038618</td>
      <td>311.683844</td>
      <td>111.935822</td>
      <td>25.892466</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>27.592626</td>
      <td>303.826685</td>
      <td>111.208683</td>
      <td>25.733566</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>27.541619</td>
      <td>296.753749</td>
      <td>110.823732</td>
      <td>25.465944</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>27.724725</td>
      <td>300.709808</td>
      <td>111.935822</td>
      <td>25.641571</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-10-17</th>
      <td>117.550003</td>
      <td>779.960022</td>
      <td>154.770004</td>
      <td>57.220001</td>
    </tr>
    <tr>
      <th>2016-10-18</th>
      <td>117.470001</td>
      <td>795.260010</td>
      <td>150.720001</td>
      <td>57.660000</td>
    </tr>
    <tr>
      <th>2016-10-19</th>
      <td>117.120003</td>
      <td>801.500000</td>
      <td>151.259995</td>
      <td>57.529999</td>
    </tr>
    <tr>
      <th>2016-10-20</th>
      <td>117.059998</td>
      <td>796.969971</td>
      <td>151.520004</td>
      <td>57.250000</td>
    </tr>
    <tr>
      <th>2016-10-21</th>
      <td>116.599998</td>
      <td>799.369995</td>
      <td>149.630005</td>
      <td>59.660000</td>
    </tr>
  </tbody>
</table>
<p>1714 rows × 4 columns</p>
</div>




```python
volume
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>GOOG</th>
      <th>IBM</th>
      <th>MSFT</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-04</th>
      <td>123432400</td>
      <td>3927000</td>
      <td>6155300</td>
      <td>38409100</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>150476200</td>
      <td>6031900</td>
      <td>6841400</td>
      <td>49749600</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>138040000</td>
      <td>7987100</td>
      <td>5605300</td>
      <td>58182400</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>119282800</td>
      <td>12876600</td>
      <td>5840600</td>
      <td>50559700</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>111902700</td>
      <td>9483900</td>
      <td>4197200</td>
      <td>51197400</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-10-17</th>
      <td>23624900</td>
      <td>1089500</td>
      <td>5890400</td>
      <td>23830000</td>
    </tr>
    <tr>
      <th>2016-10-18</th>
      <td>24553500</td>
      <td>1995600</td>
      <td>12770600</td>
      <td>19149500</td>
    </tr>
    <tr>
      <th>2016-10-19</th>
      <td>20034600</td>
      <td>116600</td>
      <td>4632900</td>
      <td>22878400</td>
    </tr>
    <tr>
      <th>2016-10-20</th>
      <td>24125800</td>
      <td>1734200</td>
      <td>4023100</td>
      <td>49455600</td>
    </tr>
    <tr>
      <th>2016-10-21</th>
      <td>22384800</td>
      <td>1260500</td>
      <td>4401900</td>
      <td>79974200</td>
    </tr>
  </tbody>
</table>
<p>1714 rows × 4 columns</p>
</div>




```python
returns = price.pct_change() # 변화율 추출
returns 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AAPL</th>
      <th>GOOG</th>
      <th>IBM</th>
      <th>MSFT</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2010-01-04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2010-01-05</th>
      <td>0.001729</td>
      <td>-0.004404</td>
      <td>-0.012080</td>
      <td>0.000323</td>
    </tr>
    <tr>
      <th>2010-01-06</th>
      <td>-0.015906</td>
      <td>-0.025209</td>
      <td>-0.006496</td>
      <td>-0.006137</td>
    </tr>
    <tr>
      <th>2010-01-07</th>
      <td>-0.001849</td>
      <td>-0.023280</td>
      <td>-0.003462</td>
      <td>-0.010400</td>
    </tr>
    <tr>
      <th>2010-01-08</th>
      <td>0.006648</td>
      <td>0.013331</td>
      <td>0.010035</td>
      <td>0.006897</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2016-10-17</th>
      <td>-0.000680</td>
      <td>0.001837</td>
      <td>0.002072</td>
      <td>-0.003483</td>
    </tr>
    <tr>
      <th>2016-10-18</th>
      <td>-0.000681</td>
      <td>0.019616</td>
      <td>-0.026168</td>
      <td>0.007690</td>
    </tr>
    <tr>
      <th>2016-10-19</th>
      <td>-0.002979</td>
      <td>0.007846</td>
      <td>0.003583</td>
      <td>-0.002255</td>
    </tr>
    <tr>
      <th>2016-10-20</th>
      <td>-0.000512</td>
      <td>-0.005652</td>
      <td>0.001719</td>
      <td>-0.004867</td>
    </tr>
    <tr>
      <th>2016-10-21</th>
      <td>-0.003930</td>
      <td>0.003011</td>
      <td>-0.012474</td>
      <td>0.042096</td>
    </tr>
  </tbody>
</table>
<p>1714 rows × 4 columns</p>
</div>




```python
returns["MSFT"].corr(returns["IBM"]), returns["MSFT"].cov(returns["IBM"]) # 상관관계, 공분산
```




    (0.49976361144151155, 8.870655479703546e-05)




```python
returns.corr(), returns.cov()
```




    (          AAPL      GOOG       IBM      MSFT
     AAPL  1.000000  0.407919  0.386817  0.389695
     GOOG  0.407919  1.000000  0.405099  0.465919
     IBM   0.386817  0.405099  1.000000  0.499764
     MSFT  0.389695  0.465919  0.499764  1.000000,
               AAPL      GOOG       IBM      MSFT
     AAPL  0.000277  0.000107  0.000078  0.000095
     GOOG  0.000107  0.000251  0.000078  0.000108
     IBM   0.000078  0.000078  0.000146  0.000089
     MSFT  0.000095  0.000108  0.000089  0.000215)




```python
returns.corrwith(returns["IBM"]) # 각열과의 상관관계
```




    AAPL    0.386817
    GOOG    0.405099
    IBM     1.000000
    MSFT    0.499764
    dtype: float64




```python
returns.corrwith(volume)
```




    AAPL   -0.075565
    GOOG   -0.007067
    IBM    -0.204849
    MSFT   -0.092950
    dtype: float64




```python
obj = pd.Series(["c", "a", "d", "a", "a", "b", "b", "c", "c"])
obj
```




    0    c
    1    a
    2    d
    3    a
    4    a
    5    b
    6    b
    7    c
    8    c
    dtype: object




```python
uniques = obj.unique()
uniques
```




    array(['c', 'a', 'd', 'b'], dtype=object)




```python
obj.value_counts() # 고유값 개수
```




    c    3
    a    3
    b    2
    d    1
    dtype: int64




```python
pd.value_counts(obj.to_numpy(), sort=False) # 넘파이 배열에서 각 값의 개수
```




    c    3
    a    3
    d    1
    b    2
    dtype: int64




```python
obj
mask = obj.isin(["b", "c"]) # isin : 찾기
mask
obj[mask]
```




    0    c
    5    b
    6    b
    7    c
    8    c
    dtype: object




```python
to_match = pd.Series(["c", "a", "b", "b", "c", "a"])
unique_vals = pd.Series(["c", "b", "a"])
indices = pd.Index(unique_vals).get_indexer(to_match)
indices
```




    array([0, 2, 1, 1, 0, 2], dtype=int64)




```python
data = pd.DataFrame({"Qu1": [1, 3, 4, 3, 4],
                     "Qu2": [2, 3, 1, 2, 3],
                     "Qu3": [1, 5, 2, 4, 4]})
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Qu1</th>
      <th>Qu2</th>
      <th>Qu3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>3</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
data["Qu1"].value_counts().sort_index() # 인덱스 오름차순
```




    1    1
    3    2
    4    2
    Name: Qu1, dtype: int64




```python
result = data.apply(pd.value_counts).fillna(0) # 인덱스 : 모든 value값 , value : 개수
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Qu1</th>
      <th>Qu2</th>
      <th>Qu3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data = pd.DataFrame({"a": [1, 1, 1, 2, 2], "b": [0, 0, 1, 0, 0]})
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.value_counts() # 행단위로 개수 파악
```




    a  b
    1  0    2
    2  0    2
    1  1    1
    dtype: int64




```python
pd.options.display.max_rows = PREVIOUS_MAX_ROWS
PREVIOUS_MAX_ROWS
```




    60




```python

```


```python

```


```python
df = pd.read_csv("pandas_practice.csv")
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강동환</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>김대천</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>김성태</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>김수경</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>김승일</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김재현</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>김주영</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>김주향</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>김지환</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>김진용</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>김희수</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>노건우</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>박동균</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>박성빈</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>박성수</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>박성진</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>박정아</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>박준규</td>
      <td>0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>서보연</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>손현동</td>
      <td>0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>송치민</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>신동훈</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>신혜람</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>양정현</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>유병우</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>유지의</td>
      <td>0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>유채영</td>
      <td>0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>윤서림</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>윤여린</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>윤정수</td>
      <td>0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>이강륜</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>이민재</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>이주영</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>이지호</td>
      <td>0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>이현상</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>인지영</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>임준열</td>
      <td>0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>임채리</td>
      <td>0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>전병훈</td>
      <td>0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>전효원</td>
      <td>0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>정대규</td>
      <td>0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>정서연</td>
      <td>0</td>
    </tr>
    <tr>
      <th>42</th>
      <td>정진아</td>
      <td>0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>정형욱</td>
      <td>0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>조성택</td>
      <td>0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>조준하</td>
      <td>0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>조중석</td>
      <td>0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>조철민</td>
      <td>0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>조효진</td>
      <td>0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>채준기</td>
      <td>0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>최송연</td>
      <td>0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>최원준</td>
      <td>0</td>
    </tr>
    <tr>
      <th>52</th>
      <td>최재혁</td>
      <td>0</td>
    </tr>
    <tr>
      <th>53</th>
      <td>최희승</td>
      <td>0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>홍예린</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



랜덤 학생 뽑기


```python
def pop_student(df=df):
    length = df.shape[0]
    rand_num = np.random.randint(0,length)
    name = df.iloc[rand_num]["이름"]
    print(f"축하합니다! {name} 학생이 당첨되었습니다")

pop_student(df)
```

    축하합니다! 정서연 학생이 당첨되었습니다
    

위의 df에서 학생의 성을 "성"이라는 컬럼에 매핑해 봅시다


```python
df["성"] = df.apply(lambda x: x["이름"][0], axis=1)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
      <th>성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강동환</td>
      <td>0</td>
      <td>강</td>
    </tr>
    <tr>
      <th>1</th>
      <td>김대천</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>2</th>
      <td>김성태</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>3</th>
      <td>김수경</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>4</th>
      <td>김승일</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김재현</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>6</th>
      <td>김주영</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>7</th>
      <td>김주향</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>8</th>
      <td>김지환</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>9</th>
      <td>김진용</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>10</th>
      <td>김희수</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>11</th>
      <td>노건우</td>
      <td>0</td>
      <td>노</td>
    </tr>
    <tr>
      <th>12</th>
      <td>박동균</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>13</th>
      <td>박성빈</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>14</th>
      <td>박성수</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>15</th>
      <td>박성진</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>16</th>
      <td>박정아</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>17</th>
      <td>박준규</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>18</th>
      <td>서보연</td>
      <td>0</td>
      <td>서</td>
    </tr>
    <tr>
      <th>19</th>
      <td>손현동</td>
      <td>0</td>
      <td>손</td>
    </tr>
    <tr>
      <th>20</th>
      <td>송치민</td>
      <td>0</td>
      <td>송</td>
    </tr>
    <tr>
      <th>21</th>
      <td>신동훈</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>22</th>
      <td>신혜람</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>23</th>
      <td>양정현</td>
      <td>0</td>
      <td>양</td>
    </tr>
    <tr>
      <th>24</th>
      <td>유병우</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>25</th>
      <td>유지의</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>26</th>
      <td>유채영</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>27</th>
      <td>윤서림</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>28</th>
      <td>윤여린</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>29</th>
      <td>윤정수</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>30</th>
      <td>이강륜</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>31</th>
      <td>이민재</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>32</th>
      <td>이주영</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>33</th>
      <td>이지호</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>34</th>
      <td>이현상</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>35</th>
      <td>인지영</td>
      <td>0</td>
      <td>인</td>
    </tr>
    <tr>
      <th>36</th>
      <td>임준열</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>37</th>
      <td>임채리</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>38</th>
      <td>전병훈</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>39</th>
      <td>전효원</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>40</th>
      <td>정대규</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>41</th>
      <td>정서연</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>42</th>
      <td>정진아</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>43</th>
      <td>정형욱</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>44</th>
      <td>조성택</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>45</th>
      <td>조준하</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>46</th>
      <td>조중석</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>47</th>
      <td>조철민</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>48</th>
      <td>조효진</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>49</th>
      <td>채준기</td>
      <td>0</td>
      <td>채</td>
    </tr>
    <tr>
      <th>50</th>
      <td>최송연</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>51</th>
      <td>최원준</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>52</th>
      <td>최재혁</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>53</th>
      <td>최희승</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>54</th>
      <td>홍예린</td>
      <td>0</td>
      <td>홍</td>
    </tr>
  </tbody>
</table>
</div>




```python
df["성"].unique().shape # 20개의 서로 다른 성씨
```




    (20,)




```python
df["성"].value_counts()
```




    김    10
    박     6
    조     5
    이     5
    최     4
    정     4
    윤     3
    유     3
    임     2
    신     2
    전     2
    채     1
    강     1
    인     1
    양     1
    송     1
    손     1
    서     1
    노     1
    홍     1
    Name: 성, dtype: int64




```python
df.loc[df["성"]=="조"]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
      <th>성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>조성택</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>45</th>
      <td>조준하</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>46</th>
      <td>조중석</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>47</th>
      <td>조철민</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>48</th>
      <td>조효진</td>
      <td>0</td>
      <td>조</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[df["성"]=="조","이름"] # 조씨인 '이름' 정보만 추출
```




    44    조성택
    45    조준하
    46    조중석
    47    조철민
    48    조효진
    Name: 이름, dtype: object




```python
df.shape[0] # 행 개수
```




    55



1. 결석한 학생들은 빼고 학생을 출력되도록 업데이트 해봅시다


```python
absence = ["조성택", "최원준", "정대규", "이강륜", "노건우", "김재현", "윤여린",
          "김희수", "최송연"]
```


```python
def pop_student_update(df=df, absence=absence):
    df_present = df[~df['이름'].isin(absence)].reset_index(drop=True)
    length = df_present.shape[0]
    rand_num = np.random.randint(0, length)
    name = df_present.iloc[rand_num]["이름"]
    print(f"축하합니다! {name} 학생이 당첨되었습니다")
    
pop_student_update(df)
```

    축하합니다! 신동훈 학생이 당첨되었습니다
    


```python
df.loc[~df["이름"].isin(absence)] # absence 제외 이름 추출
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
      <th>성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강동환</td>
      <td>0</td>
      <td>강</td>
    </tr>
    <tr>
      <th>1</th>
      <td>김대천</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>2</th>
      <td>김성태</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>3</th>
      <td>김수경</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>4</th>
      <td>김승일</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>6</th>
      <td>김주영</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>7</th>
      <td>김주향</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>8</th>
      <td>김지환</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>9</th>
      <td>김진용</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>12</th>
      <td>박동균</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>13</th>
      <td>박성빈</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>14</th>
      <td>박성수</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>15</th>
      <td>박성진</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>16</th>
      <td>박정아</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>17</th>
      <td>박준규</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>18</th>
      <td>서보연</td>
      <td>0</td>
      <td>서</td>
    </tr>
    <tr>
      <th>19</th>
      <td>손현동</td>
      <td>0</td>
      <td>손</td>
    </tr>
    <tr>
      <th>20</th>
      <td>송치민</td>
      <td>0</td>
      <td>송</td>
    </tr>
    <tr>
      <th>21</th>
      <td>신동훈</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>22</th>
      <td>신혜람</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>23</th>
      <td>양정현</td>
      <td>0</td>
      <td>양</td>
    </tr>
    <tr>
      <th>24</th>
      <td>유병우</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>25</th>
      <td>유지의</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>26</th>
      <td>유채영</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>27</th>
      <td>윤서림</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>29</th>
      <td>윤정수</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>31</th>
      <td>이민재</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>32</th>
      <td>이주영</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>33</th>
      <td>이지호</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>34</th>
      <td>이현상</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>35</th>
      <td>인지영</td>
      <td>0</td>
      <td>인</td>
    </tr>
    <tr>
      <th>36</th>
      <td>임준열</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>37</th>
      <td>임채리</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>38</th>
      <td>전병훈</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>39</th>
      <td>전효원</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>41</th>
      <td>정서연</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>42</th>
      <td>정진아</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>43</th>
      <td>정형욱</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>45</th>
      <td>조준하</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>46</th>
      <td>조중석</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>47</th>
      <td>조철민</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>48</th>
      <td>조효진</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>49</th>
      <td>채준기</td>
      <td>0</td>
      <td>채</td>
    </tr>
    <tr>
      <th>52</th>
      <td>최재혁</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>53</th>
      <td>최희승</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>54</th>
      <td>홍예린</td>
      <td>0</td>
      <td>홍</td>
    </tr>
  </tbody>
</table>
</div>



2. 뽑힌 학생들에 대해, 발표횟수를 업데이트 할 수 있도록 코드를 고쳐봅시다


```python
df.loc[df['이름']=='조성택']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
      <th>성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>조성택</td>
      <td>0</td>
      <td>조</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.loc[df['이름']=='조성택']['발표횟수'] # 발표횟수 추출
```




    44    0
    Name: 발표횟수, dtype: int64




```python
df.loc[df['이름']=='조성택','발표횟수'] +=1 # 발표횟수 1 늘리기
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>이름</th>
      <th>발표횟수</th>
      <th>성</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강동환</td>
      <td>0</td>
      <td>강</td>
    </tr>
    <tr>
      <th>1</th>
      <td>김대천</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>2</th>
      <td>김성태</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>3</th>
      <td>김수경</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>4</th>
      <td>김승일</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>5</th>
      <td>김재현</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>6</th>
      <td>김주영</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>7</th>
      <td>김주향</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>8</th>
      <td>김지환</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>9</th>
      <td>김진용</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>10</th>
      <td>김희수</td>
      <td>0</td>
      <td>김</td>
    </tr>
    <tr>
      <th>11</th>
      <td>노건우</td>
      <td>0</td>
      <td>노</td>
    </tr>
    <tr>
      <th>12</th>
      <td>박동균</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>13</th>
      <td>박성빈</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>14</th>
      <td>박성수</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>15</th>
      <td>박성진</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>16</th>
      <td>박정아</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>17</th>
      <td>박준규</td>
      <td>0</td>
      <td>박</td>
    </tr>
    <tr>
      <th>18</th>
      <td>서보연</td>
      <td>0</td>
      <td>서</td>
    </tr>
    <tr>
      <th>19</th>
      <td>손현동</td>
      <td>0</td>
      <td>손</td>
    </tr>
    <tr>
      <th>20</th>
      <td>송치민</td>
      <td>0</td>
      <td>송</td>
    </tr>
    <tr>
      <th>21</th>
      <td>신동훈</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>22</th>
      <td>신혜람</td>
      <td>0</td>
      <td>신</td>
    </tr>
    <tr>
      <th>23</th>
      <td>양정현</td>
      <td>0</td>
      <td>양</td>
    </tr>
    <tr>
      <th>24</th>
      <td>유병우</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>25</th>
      <td>유지의</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>26</th>
      <td>유채영</td>
      <td>0</td>
      <td>유</td>
    </tr>
    <tr>
      <th>27</th>
      <td>윤서림</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>28</th>
      <td>윤여린</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>29</th>
      <td>윤정수</td>
      <td>0</td>
      <td>윤</td>
    </tr>
    <tr>
      <th>30</th>
      <td>이강륜</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>31</th>
      <td>이민재</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>32</th>
      <td>이주영</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>33</th>
      <td>이지호</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>34</th>
      <td>이현상</td>
      <td>0</td>
      <td>이</td>
    </tr>
    <tr>
      <th>35</th>
      <td>인지영</td>
      <td>0</td>
      <td>인</td>
    </tr>
    <tr>
      <th>36</th>
      <td>임준열</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>37</th>
      <td>임채리</td>
      <td>0</td>
      <td>임</td>
    </tr>
    <tr>
      <th>38</th>
      <td>전병훈</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>39</th>
      <td>전효원</td>
      <td>0</td>
      <td>전</td>
    </tr>
    <tr>
      <th>40</th>
      <td>정대규</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>41</th>
      <td>정서연</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>42</th>
      <td>정진아</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>43</th>
      <td>정형욱</td>
      <td>0</td>
      <td>정</td>
    </tr>
    <tr>
      <th>44</th>
      <td>조성택</td>
      <td>1</td>
      <td>조</td>
    </tr>
    <tr>
      <th>45</th>
      <td>조준하</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>46</th>
      <td>조중석</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>47</th>
      <td>조철민</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>48</th>
      <td>조효진</td>
      <td>0</td>
      <td>조</td>
    </tr>
    <tr>
      <th>49</th>
      <td>채준기</td>
      <td>0</td>
      <td>채</td>
    </tr>
    <tr>
      <th>50</th>
      <td>최송연</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>51</th>
      <td>최원준</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>52</th>
      <td>최재혁</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>53</th>
      <td>최희승</td>
      <td>0</td>
      <td>최</td>
    </tr>
    <tr>
      <th>54</th>
      <td>홍예린</td>
      <td>0</td>
      <td>홍</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[np.random.randint(0,55)] # 0~55행 중 랜덤으로 행 추출
```




    이름      최송연
    발표횟수      0
    성         최
    Name: 50, dtype: object




```python

```


```python
frame = pd.DataFrame(np.random.standard_normal((4,3)),
                    columns=list("bde"),
                    index=["Utah", "Ohio", "Texas", "Oregon"])
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.523772</td>
      <td>-0.144327</td>
      <td>1.910040</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.808867</td>
      <td>-1.105941</td>
      <td>0.344533</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.553014</td>
      <td>0.547801</td>
      <td>0.256437</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.512917</td>
      <td>-0.878108</td>
      <td>-0.017276</td>
    </tr>
  </tbody>
</table>
</div>




```python
series2 = pd.Series(np.arange(3), index=["b", "e", "f"])
series2
```




    b    0
    e    1
    f    2
    dtype: int32




```python
frame + series2 # d는 frame에 밖에 없어서 NaN, f는 series 밖에 없어서 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
      <th>f</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.523772</td>
      <td>NaN</td>
      <td>2.910040</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.808867</td>
      <td>NaN</td>
      <td>1.344533</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.553014</td>
      <td>NaN</td>
      <td>1.256437</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.512917</td>
      <td>NaN</td>
      <td>0.982724</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
series3 = frame["d"] # d열 정보 추출
series3
```




    Utah     -0.144327
    Ohio     -1.105941
    Texas     0.547801
    Oregon   -0.878108
    Name: d, dtype: float64




```python
frame.loc[:,"d"] # d열 정보 추출
```




    Utah     -0.144327
    Ohio     -1.105941
    Texas     0.547801
    Oregon   -0.878108
    Name: d, dtype: float64




```python
frame.sub(series3, axis="index") # 인덱스 기준으로 d값 제거
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.668099</td>
      <td>0.0</td>
      <td>2.054368</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>2.914808</td>
      <td>0.0</td>
      <td>1.450473</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.005214</td>
      <td>0.0</td>
      <td>-0.291364</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-0.634809</td>
      <td>0.0</td>
      <td>0.860832</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame - series3 # series값이 부여된 열 없이 값만 있기 때문에 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ohio</th>
      <th>Oregon</th>
      <th>Texas</th>
      <th>Utah</th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
col_d = frame["d"]
df_d = pd.DataFrame(col_d)
df_d
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>-0.144327</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>-1.105941</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>0.547801</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-0.878108</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame - df_d # d열만 제거 되고 나머지 NaN
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sub(df_d)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.523772</td>
      <td>-0.144327</td>
      <td>1.910040</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.808867</td>
      <td>-1.105941</td>
      <td>0.344533</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.553014</td>
      <td>0.547801</td>
      <td>0.256437</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.512917</td>
      <td>-0.878108</td>
      <td>-0.017276</td>
    </tr>
  </tbody>
</table>
</div>




```python
def f1(x):
    return x.max() - x.min() # 최대 - 최소 함수 생성, 열 기준

frame.apply(f1)  # axis = 0 
```




    b    3.321785
    d    1.653742
    e    1.927316
    dtype: float64




```python
np.abs(frame)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.523772</td>
      <td>0.144327</td>
      <td>1.910040</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.808867</td>
      <td>1.105941</td>
      <td>0.344533</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.553014</td>
      <td>0.547801</td>
      <td>0.256437</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>1.512917</td>
      <td>0.878108</td>
      <td>0.017276</td>
    </tr>
  </tbody>
</table>
</div>




```python
x = frame["b"]
x
```




    Utah      0.523772
    Ohio      1.808867
    Texas     1.553014
    Oregon   -1.512917
    Name: b, dtype: float64




```python
f1(x)
```




    3.3217845711306135



함수보다 더 간단한 lambda


```python
frame.apply(lambda x: x.max()-x.min(), axis=0)
```




    b    3.321785
    d    1.653742
    e    1.927316
    dtype: float64




```python
frame.apply(f1, axis="columns") # 행 기준
```




    Utah      2.054368
    Ohio      2.914808
    Texas     1.296577
    Oregon    1.495641
    dtype: float64




```python
def f2(x):
    return pd.Series([x.min(),x.max()], index=["min", "max"])

frame.apply(f2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>min</th>
      <td>-1.512917</td>
      <td>-1.105941</td>
      <td>-0.017276</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.808867</td>
      <td>0.547801</td>
      <td>1.910040</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame[["min", "max"]] = frame.apply(f2, axis=1) # 새로운 인덱스로 만들기
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.523772</td>
      <td>-0.144327</td>
      <td>1.910040</td>
      <td>-0.144327</td>
      <td>1.910040</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.808867</td>
      <td>-1.105941</td>
      <td>0.344533</td>
      <td>-1.105941</td>
      <td>1.808867</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.553014</td>
      <td>0.547801</td>
      <td>0.256437</td>
      <td>0.256437</td>
      <td>1.553014</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.512917</td>
      <td>-0.878108</td>
      <td>-0.017276</td>
      <td>-1.512917</td>
      <td>-0.017276</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 엘리멘트와이즈
```


```python
def my_format(x):
    return f"{x:.2f}"
```


```python
frame.applymap(my_format) # 소수점 둘째까지 반올림
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>d</th>
      <th>e</th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>0.52</td>
      <td>-0.14</td>
      <td>1.91</td>
      <td>-0.14</td>
      <td>1.91</td>
    </tr>
    <tr>
      <th>Ohio</th>
      <td>1.81</td>
      <td>-1.11</td>
      <td>0.34</td>
      <td>-1.11</td>
      <td>1.81</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>1.55</td>
      <td>0.55</td>
      <td>0.26</td>
      <td>0.26</td>
      <td>1.55</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>-1.51</td>
      <td>-0.88</td>
      <td>-0.02</td>
      <td>-1.51</td>
      <td>-0.02</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame["e"]
```




    Utah      1.910040
    Ohio      0.344533
    Texas     0.256437
    Oregon   -0.017276
    Name: e, dtype: float64




```python
## sort
```


```python
obj = pd.Series(np.arange(4), index=["d","a","b","c"])
obj
```




    d    0
    a    1
    b    2
    c    3
    dtype: int32




```python
obj.sort_index()
```




    a    1
    b    2
    c    3
    d    0
    dtype: int32




```python

```


```python
frame = pd.DataFrame(np.arange(8).reshape((2,4)),
                    index=["three", "one"],
                    columns=["d", "a", "b","c"])
frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>three</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>one</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.sort_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>one</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <th>three</th>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python

```


```python
frame = pd.DataFrame({"b": [4.3, 7, -3, 2], "a": [0,1,0,1],
                     "c": [-2,5,8,-2.5]})

frame
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.3</td>
      <td>0</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.0</td>
      <td>1</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.0</td>
      <td>0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>1</td>
      <td>-2.5</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.shape
```




    (4, 3)




```python
frame.rank(axis="columns") # 행기준 순위
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
frame.rank(axis="index") # 열기준, 중복값은 순위의 평균으로 매김
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>b</th>
      <th>a</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>1.5</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>3.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>1.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>3.5</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python

```


```python
absence = ['조성택']
```


```python
df["이름"].isin(absence)
```




    0     False
    1     False
    2     False
    3     False
    4     False
    5     False
    6     False
    7     False
    8     False
    9     False
    10    False
    11    False
    12    False
    13    False
    14    False
    15    False
    16    False
    17    False
    18    False
    19    False
    20    False
    21    False
    22    False
    23    False
    24    False
    25    False
    26    False
    27    False
    28    False
    29    False
    30    False
    31    False
    32    False
    33    False
    34    False
    35    False
    36    False
    37    False
    38    False
    39    False
    40    False
    41    False
    42    False
    43    False
    44     True
    45    False
    46    False
    47    False
    48    False
    49    False
    50    False
    51    False
    52    False
    53    False
    54    False
    Name: 이름, dtype: bool




```python

```
